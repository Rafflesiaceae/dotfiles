#!/usr/bin/env bash
set -eo pipefail

# Read clipboard contents
content="$(cb -o)"

# Abort if content is already fenced
first_line="${content%%$'\n'*}"
if [[ $first_line == '```' ]]; then
    exit 0
fi

# Remove empty beginning and trailing empty lines
content=$(printf '%s\n' "$content" | sed '/./,$!d; $!{ /^$/d }')

# Surround with ```
# shellcheck disable=SC2016
printf '```\n%s\n```\n\n\n' "$content" | cb -i
