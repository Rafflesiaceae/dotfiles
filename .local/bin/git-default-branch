#!/bin/dash
set -e

if [ "$1" = "-l" ]; then
    branch=$(git rev-parse --abbrev-ref origin/HEAD)
    branch=${branch#origin/}
    echo "$branch"
else
    defaultbranchf="$(git-show-toplevel-path)/.git-default-branch" || true
    if [ -e "$defaultbranchf" ]; then
        cat "$defaultbranchf"
    else
        git remote show origin | grep 'HEAD branch' | awk '{print $NF}'
    fi
fi
